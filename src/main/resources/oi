#! /bin/sh


function download(){
 (
 git clone https://github.com/jschnasse/oi /tmp/oi
 cd /tmp/oi
 )
}

# Install with
function install(){
 (
 mvn package
 sudo cp src/main/resources/oi /usr/bin
 sudo cp target/oi.jar /usr/lib
 cd man
 asciidoctor -b manpage man.adoc
 sudo cp oi.1 /usr/share/man/man1/
 sudo mandb
 jlink \
    --add-modules java.base \
    --verbose \
    --strip-debug \
    --compress=1 \
    --no-header-files \
    --no-man-pages \
    --output /usr/share/jvm_for_oi
 ln -s /usr/share/jvm_for_oi/bin/java /usr/bin/jvm_for_oi
 )
}
if [ -f /usr/lib/libprocname.so ]
then
    LD_PRELOAD=/usr/lib/libprocname.so PROCNAME=oi jvm_for_oi -jar /usr/lib/oi.jar $@
else
    jvm_for_oi -jar /usr/lib/oi.jar $@
fi
